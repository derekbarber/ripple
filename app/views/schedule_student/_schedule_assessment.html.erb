<h3>Schedule Assessment</h3>


<table class="table table-striped" id="scheduleAssessmentTable">
  <thead>
    <tr>
      <th>Completed</th>
      <th>Student</th>
      <th>Family</th>
      <th>Write / View Note</th>
      <th>Primary Phone #</th>
      <th>Due Date</th>
    </tr>
  </thead>
  <tbody>
    <% if @schedule_assessment.any? %>
      <% @schedule_assessment.each do |resound_process| %>
        <%
          student = Student.find(resound_process.student_id)
        %>
        <tr>
          <td>
            <%= form_for(resound_process, :remote => true) do |t| %>
              <%= t.hidden_field :id, :value => resound_process.id %>
              <%= t.check_box :schedule_assessment,
                 :checked => resound_process.schedule_assessment,
                :class => 'checkable' %>
            <% end %>
          </td>
          <td><%= student.full_name %></td>
          <td>
            <%=
            if student.family_id && student.family_id > 0
              family = Family.find(student.family_id)
              family.family_name
            else
              "N/A"
            end
            %>
          </td>
          <td>
            <%= on_the_spot_edit resound_process, :schedule_assessment_note, :type => :textarea, :rows => 5, :columns => 45 %>
          </td>
          <td><%= number_to_phone(student.phone_number1, :area_code => true) %></td>
          <td>
            <%= form_for(resound_process, :remote => true) do |f| %>
            <%#= f.datepicker :schedule_assessment_due %>
              <%= f.text_field :schedule_assessment_due, :as => :string, :label => false, :class => 'date_picker', :style => 'width: 100px;', "data-behaviour" => 'datepicker' %>
              <%= f.submit "Update" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    <% else %>
      <tr>
        <td colspan="6">
          <p>No students awaiting an assessment at this time</p>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<script>

$('.checkable').live('change',
function() {
  if (confirm('Are you sure?')) {
    $(this).parents('form:first').submit();
  } else {
    $(this).attr('checked', false);
  }
});

</script>